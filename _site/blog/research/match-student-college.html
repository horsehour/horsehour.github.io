<!DOCTYPE html>

<html lang="en">
<head>
   <meta http-equiv="content-type" content="text/html; charset=utf-8" />
   <title>Match Students' and Colleges' Preferences</title>
   <meta name="author" content="Chunheng Jiang" />
   <link rel="shortcut icon" href="/assets/images/horse.png"/>
   <link rel="start" href="/" />

	

   <!-- Syntax highlighting CSS -->
   <link rel="stylesheet" href="/assets/css/syntax.css" type="text/css" />

   <!-- Homepage CSS -->
   <link rel="stylesheet" href="/assets/css/screen.css" type="text/css" />  
   
</head>
<body id="" onLoad="addOptions()">
<div id="site">

  <div id="header">
	<h1>
<a href="/" title="blog">Home</a>
</h1>

<ul class="nav">
<li><a class="arxiv" href="/blog/arxiv.html">Archive</a></li>
</ul>

</div>

<div id="page">

<!--<h1 class="emphnext">Match Students' and Colleges' Preferences</h1>-->
<h1>Match Students' and Colleges' Preferences</h1>

<p>Matching has many applications in real world, e.g. online dating, student recruitment for universities, 
and jobs seeking in employment market. We introduce a simple bilinear model, 
and picture the matching problem as ranking. The model provides online recommendations based on existing 
preference profiles of colleges and students.</p>

<p>Sources:
<img src="/assets/images/git.png" style="width: 30px;" />
<a href="https://github.com/horsehour/collegematch" target="_blank">GitHub</a>
<img src="/assets/images/pdf.png" style="width: 30px;" />
<a href="https://github.com/horsehour/collegematch/blob/master/Student-College%20Match.pdf" target="_blank">PDF</a>
<img src="/assets/images/tex.png" style="width: 30px;" />
<a href="/files/collegematch.tex" target="_blank">$\rm\TeX$</a></p>

<h1 id="problem">Problem</h1>

<p>Given $m$ students $\mathcal{S} = \{s_1,\ldots, s_m\}$ and $n$ colleges
$\mathcal C = \{c_1,\ldots, c_n\}$. We have the raw information
$x_i^s\in \mathbb R^{d_s}$ for a student $s_i\in \mathcal S$, and
$x_i^c\in \mathbb R^{d_c}$ for a college $c_i\in \mathcal C$. The
notations $d_s$ and $d_c$ represent the number of features in
student-profiles and college-profiles, respectively.</p>

<p>Suppose there is a transformation function
$f_i^s: \mathbb R^{d_s}\mapsto \mathbb R^d$ for $s_i\in \mathcal S$,
$g_i^s:\mathbb R^{d_c}\mapsto \mathbb R^d$ for all colleges, which is
dependent on $s_i$. The transformed feature vector for $s_i$ is
$z_i^s = (z_{i1}^s, z_{i2}^s,\ldots, z_{id}^s)\in \mathbb R^d$ and
$z_i^c = (z_{j1}^c, z_{i2}^c,\ldots, z_{id}^c)\in \mathbb R^d$ for
college $c_i\in \mathcal C$.</p>

<p>Let all the transformation functions be linear functions, and assuming
that</p>

\[\left\{
\begin{array}{rl}
z_i^s &amp; = f_i^s(x_i^s) = W_i^s x_i^s,\\
z_i^c &amp; = g_i^s(x_i^c) = V_i^s x_i^c,
\end{array}
\right.\]

<p>where $W_i^s\in \mathbb R^{d\times d_s}$ and
$V_i^s \in \mathbb R^{d\times d_c}$ are the parameter vectors in $f_i^s$
and $g_i^s$ respectively. The transformation function $g_i^s$ is
dependent on $s_i$, because it’s pretty hard to obtain the true
preference data (i.e. admission requirements or criteria) from the
college side.</p>

<p>We expect to learn these (personalized) transform functions for
students, and apply them to calculate the match score between $s_i$ and
$c_i$, i.e.</p>

\[p_{ij} = \langle z_i^s,z_i^c\rangle = \langle W_i^s x_i^s,V_i^s x_i^c\rangle, \forall 1\le i\le m, 1\le j\le n.\]

<p>Based on these scores, the prediction accuracy of the model can be
evaluated based on some ranking metrics $\mathcal M$ (e.g. MAP, NDCG).
Suppose student $s_i$ has a true preference ranking $\pi_i$ over
colleges $\mathcal C$. We expect the match scores computed using the
transformed functions produce a consistent ranking over $\mathcal C$
with $\pi_i$. Therefore the objective function in learning could be
formulated as</p>

\[\max\limits_{W_i^s,V_i^s} \mathcal M(\pi(r_i^s),\pi_i),\]

<p>where $r_i^s =(r_{i1}, r_{i2}, \ldots, r_{in})^T\in \mathbb R^n$,
$\pi(r_i^s)$ sorts colleges in descending order in terms of match scores
to $s_i$.</p>

<h1 id="pairwise-ranking-model">Pairwise Ranking Model</h1>

<p>Let $W^s\in \mathbb R^{d\times d_s}$ and
$V^c\in \mathbb R^{d\times d_c}$ are the feature transformation matrix
for students and colleges. Both are independent on a specific student or
certain a college. Therefore, given a ranking list over the colleges
from each student, we have all the pairs of colleges based on the
student’s preference profile. To student $s_i\in \mathcal S$, he or she
may have a preference rankings $\pi_{s_i}$ over some of the colleges,
saying $K=5$. Here, we assign each of the colleges in $\pi_{s_i}$ a
favorite level or score. The college in the first place will have score
$K$, the second place will be scored $K-1$, and so on. Those colleges
failing to be elected get nothing. Let $c_{[k]}^i\in \mathcal C$ be the
college receives $k$ preference level in $\pi_{s_i}$. Furthermore,
denote</p>

\[\mathbb P_{s_i} = \{(c_{[j]}^i, c_{[k]}^i), \forall K\ge j &gt; k \ge 0\}.\]

<p>A college has an implicit ranking position $K+1$ in $\pi_{s_i}$ if it
does not preferred by $s_i$.</p>

<p>We create a scoring model using the cosine similarity between students
and colleges. Therefore, the similarity between $s_i$ and $c_1$ could be
$r_{i1}=\big[W^s x_i^s\big]^T\big[V^s x_1^c\big]$, and
$r_{i2} = \big[W^s x_i^s\big]^T\big[V^s x_2^c\big]$. With some simple
manipulation, we redefine
$W=\big[W^s]^T V^c\in \mathbb R^{d_s\times d_c}$ as the product of the
original two parametric transformation matrices. The similarity between
$s_i$ and $c_1$ could be rewritten as $r_{i1} = [x_i^s]^T W x_i^c$.</p>

<p>We borrow the idea from RankNet <sup>[<a href="#manning1995introduction">manning1995introduction</a>]</sup>, 
and create a cross entropy loss
function based on all pairs of colleges in students’ preference rankings. For
the pair of colleges $(c_{[j]}, c_{[k]})\in \mathbb P_{s_i}$. We define
the <strong>true</strong> probability of $s_i$ prefers $c_{[j]}$ to $c_{[k]}$ as</p>

\[{p^*}_{jk}^i = 1/[1+e^{-|j-k|})].\]

<p>The bilinear model makes prediction
on $s_i$’s the preferences level difference on $c_{[j]}$ and $c_{[k]}$
as $o_{12}^i = [x_i^s]^T W [x_{[j]}^c-x_{[k]}^c]$, and the corresponding
probability as $p_{jk}^i = 1/[1+e^{-o_{jk}^i}]$.</p>

<p>Using the two probabilities, we define the CE loss function</p>

\[L_{jk}^i = -{p^*}_{jk}^i \log p_{jk}^i - [1-{p^*}_{jk}^i] \log [1-p_{jk}^i] = \log[1+e^{o_{jk}^i}] - {p^*}_{jk}^i o_{jk}^i,\]

<p>and optimize it based on stochastic gradient descent method. Therefore,
we have its gradient w.r.t $W$</p>

\[\frac{\partial L_{jk}^i}{\partial W} = \Big[\frac{e^{o_{jk}^i}}{1+e^{o_{jk}^i}} - {p^*}_{jk}^i\Big] \frac{\partial o_{jk}^i}{\partial W} = \big[p_{jk}^i - {p^*}_{jk}^i\big] x_i^s \big[x_{[j]}^c-x_{[k]}^c\big]^T.\]

<p>Given the learning rate $\eta&gt;0$, we update the parameter matrix $W$
iteratively over randomly selected pair of colleges with different
preference level for a specific student, saying $s_i$</p>

\[W\leftarrow W - \eta \big[p_{jk}^i - {p^*}_{jk}^i\big] x_i^s \big[x_{[j]}^c-x_{[k]}^c\big]^T, \forall j &gt; k \ge 0.\]

<p>To explicit present the two individual transformation matrix $W^s$ and
$W^c$, we can predefine a fix $d &gt; 0$ and decompose the learned
parametric matrix $W$ based on SVD.</p>

<h1 id="references">References</h1>

<p><a id="manning1995introduction">[manning1995introduction]</a>: Burges, Chris, Tal Shaked, Erin Renshaw, Ari Lazier, Matt Deeds, Nicole Hamilton, and Greg Hullender. “Learning to rank using gradient descent.” In Proceedings of the 22nd international conference on Machine learning, pp. 89-96. ACM, 2005.</p>


<!--  <address class="signature">
    <a class="author" href="http://www.horsehour.com">Chunheng Jiang</a> 
    <span class="date">16 April 2017</span>
    <span class="location"></span>
  </address>
-->

</div>


<!--
<div id="disqus_thread"></div>
<script>

(function() { // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        s.src = '//horsehour.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
})();
</script>
-->

<noscript>
Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>

  
  <div id="footer">
	<address>
		<span class="copyright">
			Content by 
			<a href="/">Chunheng Jiang</a>
			<br/>
			(<a rel="licence" href="http://creativecommons.org/licenses/by-nc-sa/3.0/">All rights reserved</a>)			
		</span>
		<span class="engine">
			<a href="http://github.com/mreid/jekyll/">Powered by Jekyll</a><br/>
			<a href="/">Design by Mark Reid</a>
		</span>
	</address>
  </div>
</div>

<!-- MathJax configuration and loading -->
<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
				"HTML-CSS": { 
	  			preferredFont: "TeX", 
	  			availableFonts: ["STIX","TeX"], 
	  			linebreaks: { automatic:true }, 
	  			EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50) 
	    	},
				tex2jax: { 
        	inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        	displayMath: [ ["$$","$$"], ["\\[", "\\]"] ], 
        	processEscapes: true, 
        	ignoreClass: "tex2jax_ignore|dno" 
        },
        TeX: {  
        	noUndefined: { attributes: {mathbackground: "#FFEEEE", mathsize: "90%" } } 
        },
	});
</script>

<!-- Latex goes here --> 
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<!-- search engines -->
<script type="text/javascript" src="/assets/js/search.js"></script>


<!-- Google Analytics script goes here --> 
<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})
	(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-105328724-1', 'auto');
	ga('send', 'pageview');
</script>

<script id="dsq-count-scr" src="//horsehour.disqus.com/count.js" async></script>
</body>
</html>

